/*!
 * @file Creates a moving network pattern
 * @copyright Raphael Koch 2020
 */
"use strict";function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var nw=function(){function t(e,n,r){var a,o,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#FFFFFF",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.8;(_classCallCheck(this,t),this.canvasId=e,this.parentId=n,this.nodeRadius=h,this.lineWidth=l,this.interactive=i,"string"==typeof r&&(7===r.length&&r.startsWith("#")&&!isNaN(Number("0x"+r.substr(1,6)))||6===r.length&&!isNaN(Number("0x"+r))))?(a=r.startsWith("#")?/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r):/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec("#"+r),this.networkColor=a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:console.error("Parsing the HEX value failed")):console.error("The given network color is not a HEX value");"string"==typeof s&&(7===s.length&&s.startsWith("#")&&!isNaN(Number("0x"+s.substr(1,6)))||6===s.length&&!isNaN(Number("0x"+s)))?(o=s.startsWith("#")?s:"#"+s,this.networkBackground=o):console.error("The given background color is not a HEX value")}return _createClass(t,[{key:"render",value:function(){var t=document.getElementById(this.canvasId),e=document.getElementById(this.parentId),n=t.getContext("2d"),r=25e3,a=parseInt(t.getAttribute("width")),o=parseInt(t.getAttribute("height")),i={r:this.networkColor.r,g:this.networkColor.g,b:this.networkColor.b},s=this.nodeRadius,h=this.lineWidth,l={r:this.networkColor.r,g:this.networkColor.g,b:this.networkColor.b},u=this.networkBackground,c=.03,d=260,p=[],f={x:0,y:0,vx:0,vy:0,r:0,type:"mouse"};function g(t){switch(t){case"top":return[b(-1,1),b(.1,1)];case"right":return[b(-1,-.1),b(-1,1)];case"bottom":return[b(-1,1),b(-1,-.1)];case"left":return[b(.1,1),b(-1,1)];default:return}}function v(){var t;switch((t=["top","right","bottom","left"])[Math.floor(Math.random()*t.length)]){case"top":return{x:m(a),y:-s,vx:g("top")[0],vy:g("top")[1],r:s,alpha:1,phase:b(0,10)};case"right":return{x:a+s,y:m(o),vx:g("right")[0],vy:g("right")[1],r:s,alpha:1,phase:b(0,10)};case"bottom":return{x:m(a),y:o+s,vx:g("bottom")[0],vy:g("bottom")[1],r:s,alpha:1,phase:b(0,10)};case"left":return{x:-s,y:m(o),vx:g("left")[0],vy:g("left")[1],r:s,alpha:1,phase:b(0,10)}}}function y(){var e;n.clearRect(0,0,a,o),n.fillStyle=u,n.fillRect(0,0,a,o),Array.prototype.forEach.call(p,function(t){t.hasOwnProperty("type")||(n.fillStyle="rgba("+i.r+","+i.g+","+i.b+","+t.alpha+")",n.beginPath(),n.arc(t.x,t.y,s,0,2*Math.PI,!0),n.closePath(),n.fill())}),function(){for(var t,e,r,a,o,i,s=0;s<p.length;s++)for(var u=s+1;u<p.length;u++)r=p[s],a=p[u],o=void 0,i=void 0,o=Math.abs(r.x-a.x),i=Math.abs(r.y-a.y),(t=Math.sqrt(o*o+i*i)/d)<1&&(e=(1-t).toString(),n.strokeStyle="rgba("+l.r+","+l.g+","+l.b+","+e+")",n.lineWidth=h,n.beginPath(),n.moveTo(p[s].x,p[s].y),n.lineTo(p[u].x,p[u].y),n.stroke(),n.closePath())}(),e=[],Array.prototype.forEach.call(p,function(t){t.x+=t.vx,t.y+=t.vy,t.x>-50&&t.x<a+50&&t.y>-50&&t.y<o+50&&e.push(t),t.phase+=c,t.alpha=Math.abs(Math.cos(t.phase))}),(p=e.slice(0)).length<t.width*t.height/r&&p.push(v()),window.requestAnimationFrame(y)}function w(){t.setAttribute("width",e.clientWidth),t.setAttribute("height",e.clientHeight),a=parseInt(t.getAttribute("width")),o=parseInt(t.getAttribute("height"))}function b(t,e){return Math.random()*(e-t)+t}function m(t){return Math.ceil(Math.random()*t)}window.addEventListener("resize",function(t){w()}),w(),function(t){for(var e=1;e<=t;e++)p.push({x:m(a),y:m(o),vx:g("top")[0],vy:g("top")[1],r:s,alpha:1,phase:b(20,50)})}(t.width*t.height/r),window.requestAnimationFrame(y),this.interactive&&(e.addEventListener("mouseenter",function(){!0,p.push(f)}),e.addEventListener("mouseleave",function(){!1;var t=[];Array.prototype.forEach.call(p,function(e){e.hasOwnProperty("type")||t.push(e)}),p=t.slice(0)}),e.addEventListener("mousemove",function(t){var e=t||window.event;f.x=e.pageX,f.y=e.pageY}))}}]),t}(),nwSetup={canvasId:"",parentId:"",networkColor:"",interactive:!0,backgroundColor:"#FFFFFF",nodeRadius:2,lineWidth:.8};function nwRender(){new nw(nwSetup.canvasId,nwSetup.parentId,nwSetup.networkColor,nwSetup.interactive,nwSetup.backgroundColor,nwSetup.nodeRadius,nwSetup.lineWidth).render()}